generator client {
  provider = "prisma-client"
  output   = "../.generated/prisma"
}

datasource db {
  provider = "sqlite"
  url      = "file:../dev.db"
}

enum Currency {
  USD
  GTQ
  ARS
  RON
}

enum ExpenseMethod {
  CASH
  CARD
  TRANSFER
}

enum RegistrationType {
  INDIVIDUAL
  CHURCH
}

model ExpenseType {
  id          Int       @id @default(autoincrement())
  name        String
  description String?
  expense     Expense[]
}

model CategoryType {
  id          Int       @id @default(autoincrement())
  name        String
  description String?
  expense     Expense[]
}

model Expense {
  id             Int           @id @default(autoincrement())
  createdAt      DateTime      @default(now())
  updatedAt      DateTime      @updatedAt
  merchant       String
  dateOfPurchase DateTime
  currency       Currency
  method         ExpenseMethod
  amount         Decimal
  memo           String?
  upload         String?
  categoryTypeId Int?
  expenseTypeId  Int?
  categoryType   CategoryType? @relation(fields: [categoryTypeId], references: [id])
  expenseType    ExpenseType?  @relation(fields: [expenseTypeId], references: [id])
}

model Profile {
  id                String             @id @default(cuid())
  createdAt         DateTime           @default(now())
  updatedAt         DateTime           @updatedAt
  email             String
  fName             String?
  lName             String?
  churchName        String?
  dob               DateTime?
  street            String?
  city              String?
  state             String?
  postal            String?
  phone             String?
  tripRegistrations TripRegistration[] @relation("ProfileTripRegistration")
}

model TripRegistration {
  id               String           @id @default(cuid())
  createdAt        DateTime         @default(now())
  updatedAt        DateTime         @updatedAt
  profiles         Profile[]        @relation("ProfileTripRegistration")
  registrationType RegistrationType @default(INDIVIDUAL)
  tripId           String
  trip             Trip             @relation(fields: [tripId], references: [id])
}

model Trip {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  startDate DateTime
  endDate   DateTime
  groupSize Int

  registrations TripRegistration[]
}
